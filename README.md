–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: 

–ù–µ –ó–ê–ë–£–î–¨ —É–ª–∞–¥–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:
https://chat.qwen.ai/c/3875011f-8a1c-4df3-a0b7-841a609cd968
code.txt

–ö–æ–Ω–µ—Ü –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
===

# –ê–Ω—Å–∞–º–±–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞ —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π —Ä–µ—à–µ–Ω–∏–π (SHAP) –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π PDF-–æ—Ç—á—ë—Ç–æ–≤

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è: RF + XGBoost + CatBoost
- AutoML —Å PyCaret
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å SHAP
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF-–æ—Ç—á—ë—Ç–∞

## –ó–∞–ø—É—Å–∫
```bash

uvicorn app.main:app --reload
streamlit run frontend/app.py

–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

    –ó–∞–ø—É—Å—Ç–∏ FastAPI:
    bash
    cd app && uvicorn main:app --reload
    
    –ó–∞–ø—É—Å—Ç–∏ Streamlit:
    bash
    cd frontend && streamlit run app.py
    
    –í–≤–µ–¥–∏ –¥–∞–Ω–Ω—ã–µ ‚Üí –Ω–∞–∂–º–∏:

üîÆ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å ‚Üí —É–≤–∏–¥–∏—à—å SHAP

üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç –≤ PDF ‚Üí —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ reports/


===
Backend (FastAPI):

    cd app
    #uvicorn main:app --reload
    uvicorn main:app --host 127.0.0.1 --port 8000
    
    –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–Ω—è—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä–∏–π —Å 2-—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫ –≤ main.py:
    if __name__ == "__main__":
    uvicorn.run(
        app, 
        host="0.0.0.0", 
        port=8000,
        reload=False # –ü–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –ø–æ—Ç–æ–º —É–±—Ä–∞—Ç—å
    )

    script: (—Å–≤–æ–π –ø—É—Ç—å)/home/wka/code/–¥–∏–ø–ª–æ–º/code/credit_scoring/app/myapp.py !!!
    Script parametrs - –ø—É—Å—Ç–æ
    Working directory: (—Å–≤–æ–π –ø—É—Ç—å)/home/wka/code/–¥–∏–ø–ª–æ–º/code/credit_scoring/app/ !!!

Frontend (Streamlit):

    cd frontend
    streamlit run app.py


–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
–†–∞–±–æ—Ç–∞ —Å —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

    –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏–º –∫–æ–º–∞–Ω–¥—É:
    python init_db.py

    –ü–æ—è–≤–∏—Ç—å—Å—è —Ñ–∞–π–ª users.db —Å —Ç–∞–±–ª–∏—Ü–µ–π users
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin —Å –ø–∞—Ä–æ–ª–µ–º password123

    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite
    –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ HTTP Basic Auth
    –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
    –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –∫–æ–¥ –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

‚úÖ –ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å:
    
    REST API –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏: Bagging, Boosting, Stacking, Blending.
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PyCaret.
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π UI –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è.

üìå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–¥–ª—è –¥–∏–ø–ª–æ–º–∞):

    –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (SHAP, feature_importances_).
    –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ (joblib) –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏—Ö –≤ API.
    –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á–µ—Ç—ã (classification_report, ROC AUC, confusion matrix).

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

    1Ô∏è‚É£ üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger
    FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —á–µ—Ä–µ–∑ Swagger –∏ ReDoc.

    –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:

    Swagger: http://localhost:8000/docs
    ReDoc: http://localhost:8000/redoc
    
    –ù–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–∏—Å–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ , –æ–Ω–∞ —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é!

‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

    pytest tests/


üöÄ –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º:
    
    –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞: http://localhost:8000
    –í—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ data/credit_risk_dataset.csv
    –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è df –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ

üìå 1. Root ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞

    curl -u admin:password123 -X GET "http://localhost:8000"

    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {"message": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Credit Scoring API"}

üßπ 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ ‚Äî /outliers
    
    curl -u admin:password123 -X POST "http://localhost:8000/outliers"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "message": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã",
      "count_before": 32581,
      "count_after": 29381
    }

üîß 3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏—á–µ–π (Feature Engineering) ‚Äî /feature-engineering

    curl -u admin:password123 -X POST "http://localhost:8000/feature-engineering"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "message": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏—á–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∞",
      "features": ["person_age", "person_income", ...]
    }

üìä 4. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî /preprocessing

    curl -u admin:password123 -X POST "http://localhost:8000/preprocessing"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "message": "–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
      "shape": [950, 22]
    }

ü§ñ 5. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π ‚Äî /train-models

    curl -u admin:password123 -X POST "http://localhost:8000/train-models"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä): json
    {
      "results": {
        "RandomForest": 0.89,
        "XGBoost": 0.91,
        "LightGBM": 0.92,
        "CatBoost": 0.93,
        "Stacking": 0.94,
        "Blending": 0.93
      }
    }

‚öôÔ∏è 6. –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Äî /tune-hyperparameters
    
    curl -u admin:password123 -X POST "http://localhost:8000/tune-hyperparameters"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "best_params": {
        "n_estimators": 100,
        "max_depth": 5
      }
    }

‚úÖ 7. –û–±—É—á–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ ‚Äî /train-final

    curl -u admin:password123 -X POST "http://localhost:8000/train-final"
    
    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "model": "RandomForest",
      "accuracy": 0.94
    }

üß† 8. AutoML —Å PyCaret ‚Äî /run-automl

    curl -u admin:password123 -X POST "http://localhost:8000/run-automl"

    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "automl_result": {
        "best_model": "XGBoost"
      }
    }

üìà 9. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî /predict
    
    –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
    curl -u admin:password123 -X POST "http://localhost:8000/predict" \
     -H "Content-Type: application/json" \
     -d '{
           "person_age": 35,
           "person_income": 75000,
           "person_home_ownership": "RENT",
           "person_emp_length": 5.0,
           "loan_intent": "DEBTCONSOLIDATION",
           "loan_grade": "B",
           "loan_amnt": 20000,
           "loan_int_rate": 9.5,
           "loan_percent_income": 0.27,
           "cb_person_default_on_file": "N",
           "cb_person_cred_hist_length": 4
         }'

    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "prediction": 0
    }
    
    0 = –∫–ª–∏–µ–Ω—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ –ø–æ–≥–∞—Å–∏—Ç –∫—Ä–µ–¥–∏—Ç
    1 = –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –¥–µ—Ñ–æ–ª—Ç–∞ 

    –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç FastAPI)
    –ï—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å:

    json
    {
        "person_age": 15,
        ...
    }

    –ü–æ–ª—É—á–∏—à—å:
    json
    {
      "detail": [
        {
          "loc": ["body", "person_age"],
          "msg": "–í–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 18 –¥–æ 100 –ª–µ—Ç",
          "type": "value_error"
        }
      ]
    }

    –û—à–∏–±–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π loan_grade):
    bash
    curl -u admin:password123 -X POST http://localhost:8000/predict \
         -H "Content-Type: application/json" \
        -d '{
               "person_age": 135,
               "person_income": 75000,
               "person_home_ownership": "RENT",
               "person_emp_length": 5.0,
               "loan_intent": "DEBTCONSOLIDATION",
               "loan_grade": "X",
               "loan_amnt": 20000,
               "loan_int_rate": 9.5,
               "loan_percent_income": 0.27,
               "cb_person_default_on_file": "N",
               "cb_person_cred_hist_length": 4
             }'
    –ü–æ–ª—É—á–∏—à—å:
    json
    {
      "detail": [
        {
          "loc": ["body", "loan_grade"],
          "msg": "value is not a valid enumeration member; permitted: 'A', 'B', 'C', 'D', 'E', 'F', 'G'",
          "type": "type_error.enum"
        }
      ]
    }

üìÑ 10. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF-–æ—Ç—á–µ—Ç–∞ (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω) ‚Äî /report

    curl -u admin:password123 -X POST "http://localhost:8000/report" \
        -H "Content-Type: application/json" \
        -d '{
               "person_age": 35,
               "person_income": 75000,
               "person_home_ownership": "RENT",
               "person_emp_length": 5.0,
               "loan_intent": "DEBTCONSOLIDATION",
               "loan_grade": "X",
               "loan_amnt": 20000,
               "loan_int_rate": 9.5,
               "loan_percent_income": 0.27,
               "cb_person_default_on_file": "N",
               "cb_person_cred_hist_length": 4
             }'

    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: json
    {
      "report_path": "reports/model_comparison_report.pdf"
    }

    11. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ - /explain

  
    curl -u admin:password123 -X POST http://localhost:8000/explain \
         -H "Content-Type: application/json" \
         -d '{
               "person_age": 45,
               "person_income": 120000,
               "person_home_ownership": "OWN",
               "person_emp_length": 15.0,
               "loan_intent": "HOMEIMPROVEMENT",
               "loan_grade": "A",
               "loan_amnt": 15000,
               "loan_int_rate": 6.0,
               "loan_percent_income": 0.1,
               "cb_person_default_on_file": "N",
               "cb_person_cred_hist_length": 10
             }'

    –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
    json
    {
      "prediction": 0,
      "status": "repaid",
      "decision": "approve",
      "probability_default": 0.12,
      "probability_repaid": 0.88,
      "explanation": {
        "base_value": 0.45,
        "shap_values": [
          {"feature": "person_income", "value": -0.31},
          {"feature": "loan_grade_A", "value": -0.25},
          {"feature": "loan_percent_income", "value": 0.18},
          {"feature": "cb_person_default_on_file_N", "value": -0.15},
          {"feature": "person_home_ownership_OWN", "value": -0.12}
        ],
        "summary": [
          "person_income: ‚Üì —Ä–∏—Å–∫ (-0.310)",
          "loan_grade_A: ‚Üì —Ä–∏—Å–∫ (-0.250)",
          "loan_percent_income: ‚Üë —Ä–∏—Å–∫ (+0.180)",
          "cb_person_default_on_file_N: ‚Üì —Ä–∏—Å–∫ (-0.150)",
          "person_home_ownership_OWN: ‚Üì —Ä–∏—Å–∫ (-0.120)"
        ]
    }

    12. –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (feedback)
    
    curl -u admin:password123 -X POST http://localhost:8000/feedback \
         -H "Content-Type: application/json" \
         -d '{
               "person_age": 45,
               "person_income": 120000,
               "person_home_ownership": "OWN",
               "person_emp_length": 15.0,
               "loan_intent": "HOMEIMPROVEMENT",
               "loan_grade": "A",
               "loan_amnt": 15000,
               "loan_int_rate": 6.0,
               "loan_percent_income": 0.1,
               "cb_person_default_on_file": "N",
               "cb_person_cred_hist_length": 10
             }', "actual_status": "default"

‚úÖ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?
    
    –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:
    
    cd app && uvicorn main:app --reload
    –û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—Å—Ç–∞–≤—å –Ω—É–∂–Ω—ã–π curl-–∑–∞–ø—Ä–æ—Å –≤—ã—à–µ
    –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤)
